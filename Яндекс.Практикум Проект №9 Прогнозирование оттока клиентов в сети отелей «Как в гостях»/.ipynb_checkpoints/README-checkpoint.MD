# Прогнозирование оттока клиентов в сети отелей «Как в гостях»
[Проект](Яндекс.Практикум%20Проект%20№9%20Прогнозирование%20оттока%20клиентов%20в%20сети%20отелей%20«Как%20в%20гостях».ipynb)  
# Постановка задачи:    
Заказчик этого исследования — сеть отелей «Как в гостях». 
Чтобы привлечь клиентов, эта сеть отелей добавила на свой сайт возможность забронировать номер без предоплаты. Однако если клиент отменял бронирование, то компания терпела убытки. Сотрудники отеля могли, например, закупить продукты к приезду гостя или просто не успеть найти другого клиента.
Чтобы решить эту проблему, вам нужно разработать систему, которая предсказывает отказ от брони. Если модель покажет, что бронь будет отменена, то клиенту предлагается внести депозит. Размер депозита — 80% от стоимости номера за одни сутки и затрат на разовую уборку. Деньги будут списаны со счёта клиента, если он всё же отменит бронь.
# Навыки и инструменты:  
* **python**
* **pandas**
* **numpy**
* **seaborn**
* **matplotlib**
* **sklearn.dummy.DummyClassifier**
* **sklearn.tree.DecisionTreeClassifier**
* **sklearn.ensemble.RandomForestClassifier**
# Общий вывод:
**Шаг 1. Откройте файлы с данными:**
- В данных отсутствуют нарушения правил хорошего стиля в названии столбцов
- В данных отсутствуют пропуски
- Мы выяснили, что нам необходимо будет поменять тип данных в столбцах `adults`, `children` и `babies` на этапе предобработки данных на `int64`
- Проанализировав значения из матрицы корреляции признаков, можно сформулировать гипотезу об отсутствии мультиколлинеарности в данных. Исключением является наличие высокого значения корреляции между признаками `stays_in_weekend_nights`, `stays_in_week_nights` и `total_nights`. В самом деле: $total\_nights = stays\_in\_weekend\_nights + stays\_in\_week\_nights$

**Шаг 2. Предобработка и исследовательский анализ данных:**
- В данных присутствует дисбаланс классов (отмены бронирования происходят не часто)
- Чаще всего отменяют заказы в месяца со значениями `10` и `11` (`Октябрь` и `Сентябрь` без кодирования)
- Чаще всего номер бронируется для `2`-ух взрослых людей без детей и младенцев
- Чаще всего номер бронируется с дополнительной опцией `0` (`BB — включён завтрак` без кодирования)
- Чаще всего бронирование совершают клиенты с кодом страны `117` (гражданство `Португалии` без кодирования)
- Чаще всего бронирование происходит в первый раз
- Чаще всего клиент ранее не делал отмену бронирования
- Чаще всего тип забронированной комнаты равен `0` (категория `A` без кодирования)
- Мы отчистили данные, предназначенные для обучения модели, от аномальных значений
- Можно сформулировать гипотезу о том, что клиенты, которые ранее совершали отмену бронирования, зачастую делают это снова
- Можно сформулировать гипотезу о том, что клиенты с большим количеством дней между датой бронирования и датой прибытия чаще отменяют бронирование
- Можно сформулировать гипотезу о том, что клиенты с гражданством Португалии чаще отменяют бронирование
- Можно сформулировать гипотезу о том, что клиенты с нулевым количеством специальных отметок чаще отменяют бронирование

**Шаг 3. Формулировка ML-задачи на основе бизнес-задачи:**
- Прибыль отеля без внедрения депозитов — `32525370.0`

**Шаг 4. Разработка модели ML:**
- Лучше всего себя показал модель `RandomForestClassifier` с гиперпараметрами `criterion` — `gini`, `max_depth` — `6` и `n_estimators` — `3`. Значение `F1-меры` этой модели при кросс-валидации `0.6654`
- Значение `F1-меры` для наилучшей модели `RandomForestClassifier` на тестовых данных — `0.6505`
- Значение `accuracy` для наилучшей модели `RandomForestClassifier` на тестовых данных — `0.7429`
- Значение `accuracy` для наивной модели на тестовых данных — `0.6115`
- Площадь под `ROC-кривой` наулучшей модели `RandomForestClassifier` (`AUC-ROC`) равна — `0.7836`
- Прибыль отеля с внедрением депозитов и учётом бюджета на разработку системы прогнозирования — `41316114.0`

**Шаг 5. Опишите портрет «ненадёжного» клиента:**  
Из исследовательского анализа данных, проведённого выше, "ненадёжного" клиента можно описать следующим образом:
- У него имеется как минимум одна отмена бронирования в прошлом
- Он сделал бронирование задолго до даты прибытия. То есть количество дней между датой бронирования и датой прибытия велико
- Он гражданин Португалии
- У него нет специальных отметок в бронировании